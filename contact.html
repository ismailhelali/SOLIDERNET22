<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <style>
      /* Add some styling for the form and table */
      form {
        display: flex;
        flex-direction: column;
      }

      input[type="text"] {
        padding: 0.5em;
        margin: 0.5em;
      }

      button[type="submit"], button[type="button"] {
        padding: 0.5em;
        margin: 0.5em;
        cursor: pointer;
        background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        font-size: 16px;
      }

      table {
        border-collapse: collapse;
        width: 100%;
      }

      td, th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
      }

      tr:nth-child(even) {
        background-color: #dddddd;
      }
    </style>
  </head>
  <body>
    <form id="form">
      <!-- Ask for the user's name or the name of the company -->
      <label for="name" style="font-weight: bold;">Name:</label>
      <input type="text" id="name" style="width: 50%;" />
      <!-- Add a button to add a product to the table -->
      <button type="button" onclick="addProduct()" style="margin-top: 1em;">Add Product</button>
      
      
      
       <!-- Create a table to display the products -->
      <table id="products" style="margin-top: 1em;">
        <tr>
          <th>Product Name</th>
        </tr>
      </table>
      <!-- Add a button to send the list as a PDF to a WhatsApp number -->
      <button type="button" onclick="sendJPEG()" style="margin-top: 1em;">Send List</button>
    </form>

    <script>
      function addProduct() {
        // Get the product name from the user
        var productName = prompt("Enter the product name:");
        // Check if the user entered a product name
        if (productName) {
          // Get the table element
          var table = document.getElementById("products");
          // Create a new row for the product
          var row = table.insertRow();
          // Create a cell for the product name
          var cell = row.insertCell();
          // Set the cell's text to the product name
          cell.innerHTML = productName;
        }
      }
      
      function sendJPEG() {
        // Get the user's name
        var name = document.getElementById("name").value;
        // Get the products table
        var productsTable = document.getElementById("products");
        // Get the loading indicator element
        var loadingIndicator = document.getElementById("loading-indicator");

        // Check if the user has entered a name
        if (!name) {
          alert("Please enter your name or the name of the company.");
          return;
        }

        // Check if there are any products in the table
        if (productsTable.rows.length <= 1) {
          alert("Please add at least one product to the list.");
          return;
        }

        // Check if the window.open function is supported
        if (!window.open) {
          alert("Your browser does not support the window.open function. Please try a different browser or device.");
          return;
        }

        // Show the loading indicator
        loadingIndicator.style.display = "block";

        try {
          // Use html2canvas to convert the table to a canvas element
          html2canvas(productsTable).then(function(canvas) {
            // Convert the canvas to a JPEG image
            var jpeg = canvas.toDataURL("image/jpeg");
            // Create a new PDF document
            var pdf = new jsPDF("p", "mm", "a4");
            // Add the JPEG image to the PDF document
            pdf.addImage(jpeg, "JPEG", 0, 0);
            // Save the PDF document
            pdf.save("products.pdf");
            // Open a new window with the WhatsApp URL and the PDF document as an attachment
            window.open(`whatsapp://send?text=&attach=${encodeURIComponent(pdf.output("blob"))}`);
            // Hide the loading indicator
            loadingIndicator.style.display = "none";
          });
        } catch (error) {
          // If an error occurs, hide the loading indicator and show an error message
          loadingIndicator.style.display = "block";
          }
    </script>
    
    </html>
