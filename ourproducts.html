<!DOCTYPE html>
<html>
<head>
  <title>Product List</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
<input type="text" id="search">
<button id="clear-search">Show All</button>
  <h1>Categories</h1>
  <div id="categories">
    <!-- Category titles will be inserted here -->
  </div>
  <script>
  const data = {
  categories: [
    {
      title: 'Category 1',
      products: [
        { title: 'Product 1', checked: false },
        { title: 'Product 2', checked: false }
      ]
    },
    {
      title: 'Category 2',
      products: [
        { title: 'Product 3', checked: false },
        { title: 'Product 4', checked: false }
      ]
    }
  ]
};

function render() {
  // Set the categories and products to the original data
  let categories = data.categories;

  // Filter the categories and products based on the search query
  const searchQuery = $('#search').val().toLowerCase();
  if (searchQuery.trim() !== '') {
    categories = categories.map((category) => {
      const products = category.products.filter((product) => {
        return product.title.toLowerCase().includes(searchQuery);
      });
      return { ...category, products };
    });
  }

  // Generate the HTML for the categories and products
  const categoriesHtml = categories.map((category) => {
    const productsHtml = category.products.map((product) => {
      return `
        <div class="product-item">
          <input type="checkbox" class="product-checkbox" ${product.checked ? 'checked' : ''}>
          <span class="product-title">${product.title}</span>
          <label>
            Quantity:
            <input type="number" class="product-quantity">
          </label>
          <label>
            Unit:
            <input type="text" class="product-unit">
          </label>
        </div>
      `;
    }).join('');

    return `
      <div class="category">
        <h2 class="category-title">${category.title}</h2>
        <div class="category-products">${productsHtml}</div>
      </div>
    `;
  }).join('');

  $('#categories').html(categoriesHtml);
}

// Initial render
render();

$('#search').on('input', () => {
  render();
});

$(document).on('change', '.product-checkbox', (event) => {
  const checkbox = $(event.target);
  const productElement = checkbox.parent();
  const categoryElement = productElement.parent();

  // Find the index of the product and category in the data object
  const productIndex = productElement.index();
  const categoryIndex = categoryElement.index();

  // Update the checked property of the product object
  data.categories[categoryIndex].products[productIndex].checked = checkbox.prop('checked');

  // Re-render the categories and products
  render();
});

$('#clear-search').on('click', () => {
  $('#search').val('');
  render();
});

</script>
</body>
</html>
